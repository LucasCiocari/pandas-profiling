<!DOCTYPE html>
<meta charset="utf-8">
<!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"> -->

<head>

  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">

</head>

<body>

  <select id="sel_a_bid_viz" class="select_item_viz"></select>
  <button id="swap_btn_bid_viz" class="swap_btn_viz">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="exchange-alt"
      class="svg-inline--fa fa-exchange-alt fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" width=20 height=15
      viewBox="0 0 512 512">
      <path fill="currentColor"
        d="M0 168v-16c0-13.255 10.745-24 24-24h360V80c0-21.367 25.899-32.042 40.971-16.971l80 80c9.372 9.373 9.372 24.569 0 33.941l-80 80C409.956 271.982 384 261.456 384 240v-48H24c-13.255 0-24-10.745-24-24zm488 152H128v-48c0-21.314-25.862-32.08-40.971-16.971l-80 80c-9.372 9.373-9.372 24.569 0 33.941l80 80C102.057 463.997 128 453.437 128 432v-48h360c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24z">
      </path>
    </svg></button>
  <select id="sel_b_bid_viz" class="select_item_viz"></select>

  <div id="bid_viz"></div>

  <link rel="stylesheet" href="index.css">
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
    integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
    integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
    integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous">
    </script>
  <script src="index.js"></script>
</body>

<style>
  .highlight_bid_viz {
    fill-opacity: 1;
    stroke-opacity: 1;
  }

  .fade_bid_viz {
    fill-opacity: 0.06;
    stroke-opacity: 0;
  }

  .select_item_viz {
    width: 300px;
    height: 46px;
    border-radius: 2%;
    border: 1px black solid;
    text-align: center;
    font-family: 'Roboto', sans-serif;
    font-size: 16px;
    cursor: pointer;

  }

  .swap_btn_viz {
    height: 46px;
    border-radius: 20%;
    border: none;
    background-color: lavender;
    cursor: pointer;
  }
</style>

<script>
  function plotBidGraph(data, full_matrix, sel_a, sel_b, btn_swap) {
    let dimensions = Object.keys(data)
    let labels = [];
    let matrix = [];

    const r_dim_color = "#black"
    let l_dim_colors = []
    const width = 800
    const height = 800

    const innerRadius = 260
    const outerRadius = 275

    const entity_padding = 0.05
    let select_a = sel_a
    let select_b = sel_b
    let swap_btn = btn_swap
    let hold_shown_values = false

    function generate_colors(values) {

      const quantity = (values.find(val => val === "missing value") != undefined) ? values.length - 1 : values.length
      const divisor = quantity > 0 ? 360 / quantity : 1

      let color_array = []
      for (let i = 1; i <= quantity; i++) {
        color_array.push(`hsl(${divisor * i}, 50%, 50%)`)
      }

      return color_array
    }

    function zeros(len1, len2) {
      let arr = [];
      for (let i = 0; i < len1; i++) {
        arr.push(0);
      }
      let mat = []
      if (len2 !== undefined) {
        for (let i = 0; i < len2; i++) {
          mat.push(arr);
        }
        return Array.from(mat);
      }
      return Array.from(arr);
    }

    function concat_matrix(f_mat, s_mat) {
      let ret_mat = [];
      for (i = 0; i < f_mat.length; i++) {
        ret_mat.push(f_mat[i].concat(s_mat[i]));
      }
      return Array.from(ret_mat);
    }

    function join_matrix(f_mat, s_mat) {
      let ret_mat = f_mat;

      for (i = 0; i < s_mat.length; i++) {
        ret_mat.push(s_mat[i])
      }

      return Array.from(ret_mat);
    }

    function node_mouseover(svg, d) {
      if (!hold_shown_values) {
        svg.selectAll('.nodes').classed('fade_bid_viz', true)
        svg.selectAll(`.node-${d.index}`).classed('highlight_bid_viz', true)
        svg.selectAll('.ribbons').classed('fade_bid_viz', true)


        for (let i = 0; i < matrix.length; i++) {
          svg.selectAll(`.ribbon-${d.index}-${i}`).classed('highlight_bid_viz', true).moveToFront()
          svg.selectAll(`.ribbon-${i}-${d.index}`).classed('highlight_bid_viz', true).moveToFront()
        }


        let numbers = new Set();
        svg
          .selectAll(".ribbons")
          .selectAll("*")
          .filter(val => val.source.index === d.index || val.source.subindex === d.index || val.target.index ===
            d.index || val.target.subindex === d.index)
          ._groups[0]
          .forEach(
            (val) => {
              numbers.add(val.className.baseVal.split(" ")[0].split("-")[1])
              numbers.add(val.className.baseVal.split(" ")[0].split("-")[2])
            }
          )

        for (let item of numbers) svg.selectAll(`.node-${item}`).classed('highlight_bid_viz', true)
      }
    }

    function node_mouseout(svg, d) {
      if (!hold_shown_values) {
        svg.selectAll('.nodes').classed('fade_bid_viz', false)
        svg.selectAll(`.node-${d.index}`).classed('highlight_bid_viz', false)
        svg.selectAll('.ribbons').classed('fade_bid_viz', false)
        svg.selectAll(`.ribbon-`).classed('highlight_bid_viz', false)
        for (let i = 0; i < matrix.length; i++) {
          svg.selectAll(`.ribbon-${d.index}-${i}`).classed('highlight_bid_viz', false)
          svg.selectAll(`.ribbon-${i}-${d.index}`).classed('highlight_bid_viz', false)
        }

        let numbers = new Set();
        let x = document.querySelectorAll(`[class^="ribbon-"]`)
        for (let i = 0; i < x.length; i++) {
          if (x[i].className.baseVal.indexOf(d.index.toString()) != -1) {
            numbers.add(x[i].className.baseVal.split(" ")[0].split("-")[1])
            numbers.add(x[i].className.baseVal.split(" ")[0].split("-")[2])
          }
        }

        for (let item of numbers) svg.selectAll(`.node-${item}`).classed('highlight_bid_viz', false)
      }
    }

    function chord_mouseover(svg, d) {
      if (!hold_shown_values) {
        svg.selectAll('.ribbons').classed('fade_bid_viz', true)
        svg.selectAll(`.ribbon-${d.source.index}-${d.target.index}`).classed('highlight_bid_viz', true)
          .moveToFront()
        svg.selectAll('.nodes').classed('fade_bid_viz', true)
        svg.selectAll(`.node-${d.source.index}`).classed('highlight_bid_viz', true)
        svg.selectAll(`.node-${d.target.index}`).classed('highlight_bid_viz', true)
      }
    }

    function chord_mouseout(svg, d) {
      if (!hold_shown_values) {
        svg.selectAll('.ribbons').classed('fade_bid_viz', false)
        svg.selectAll(`.ribbon-${d.source.index}-${d.target.index}`).classed('highlight_bid_viz', false)
        svg.selectAll('.nodes').classed('fade_bid_viz', false)
        svg.selectAll(`.node-${d.source.index}`).classed('highlight_bid_viz', false)
        svg.selectAll(`.node-${d.target.index}`).classed('highlight_bid_viz', false)
      }
    }

    function all_on_click() {
      console.log(hold_shown_values);
      hold_shown_values = hold_shown_values ? false : true
      console.log(hold_shown_values);
    }

    function def_layout(matrix, entity_padding) {
      return d3.chord()
        .padAngle(entity_padding)
        .sortSubgroups(d3.ascending)
        (matrix)
    }

    function update_matrix(dim_l, dim_r) {
      let new_matrix = []

      for (let i = data[dim_r]['start_i']; i < data[dim_r]['end_i']; i++) {
        let new_list = []
        for (let j = data[dim_l]['start_i']; j < data[dim_l]['end_i']; j++) {
          new_list.push(full_matrix[i][j])
        }
        new_matrix.push(new_list)
        new_list = []
      }

      const new_matrix_t = new_matrix[0].map((col, i) => new_matrix.map(row => row[i]))
      const first_zeros = zeros(new_matrix.length, new_matrix.length);
      const second_zeros = zeros(new_matrix[0].length, new_matrix[0].length);
      const build_matrix_top = concat_matrix(first_zeros, new_matrix);
      const build_matrix_bot = concat_matrix(new_matrix_t, second_zeros);
      const end_matrix = join_matrix(build_matrix_top, build_matrix_bot);

      return end_matrix;
    }

    function update_viz(dim_l, dim_r) {

      d3.select("#bid_viz").selectAll("*").remove();

      let svg = d3.select("#bid_viz")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("viewbox", `0 0 600 600`)
        .append("g")
        .attr("transform", `translate(${width / 2},${height / 2})`)

      let res = def_layout(matrix, entity_padding)

      //Nodes insert
      let color_count = -1
      svg
        .datum(res)
        .append("g")
        .attr("class", "nodes")
        .selectAll("g")
        .data(d => d.groups)
        .enter()
        .append("g")
        .attr("class", d => `node-${d.index}`)
        .append("path")
        .style("fill", (d, i) => {
          if (i < data[dim_r]['values'].length) {
            if (data[dim_r]['values'][i] == "missing value") {
              d.color = "white";
              return "white";
            } else {
              color_count += 1
              d.color = l_dim_colors[color_count]
              return l_dim_colors[color_count]
            }
          } else {
            if (data[dim_l]['values'][i - data[dim_r]['values'].length] == "missing value") {
              d.color = "white"
              return "white"
            } else {
              d.color = r_dim_color
              return r_dim_color
            }
          }
        })
        .style("stroke", d => d.color == "white" ? "black" : d3.rgb(d.color).darker())
        .attr("d", d3.arc().innerRadius(innerRadius).outerRadius(outerRadius))
        .on('mouseover', d => {
          node_mouseover(svg, d)
        })
        .on('mouseout', d => {
          node_mouseout(svg, d)
        })
        .on("click", d => all_on_click())
      //Text insert
      svg.selectAll(".nodes")
        .selectAll("g")
        .append("text")
        .each(d => {
          d.angle = (d.startAngle + d.endAngle) / 2;
        })
        .attr("dy", ".35em")
        .attr("transform", d => `
      rotate(${(d.angle * 180 / Math.PI - 90)})
      translate(${innerRadius + 26})
      ${d.angle > Math.PI ? "rotate(180)" : ""}
    `)
        .attr("text-anchor", d => d.angle > Math.PI ? "end" : null)
        .text(d => labels[d.index])
        .attr("font-family", "Roboto")

      //Chords insert
      svg
        .datum(res)
        .append("g")
        .attr("class", "ribbons")
        .selectAll("path")
        .data(d => d)
        .enter()
        .append("path")
        .attr("d", d3.ribbon().radius(innerRadius))
        .style("fill", d => {
          d.color = svg.select(`.node-${d.source.index}`)._groups[0][0].firstChild.style.fill
          return d.color
        })
        .style("stroke", d => d.color == "white" ? "black" : d3.rgb(d.color).darker())
        .attr("class", d => `ribbon-${d.source.index}-${d.target.index}`)
        .style("opacity", ".80")
        .on('mouseover', d => chord_mouseover(svg, d))
        .on('mouseout', d => chord_mouseout(svg, d))
        .on("click", d => all_on_click())
    }

    function select_on_change() {

      const dim_l = select_a.value;
      const dim_r = select_b.value;
      l_dim_colors = generate_colors(data[dim_r]['values']);
      update_selects(dim_l, dim_r);
      labels = data[dim_r]['values'].concat(data[dim_l]['values']);
      matrix = update_matrix(dim_l, dim_r);
      update_viz(dim_l, dim_r);
    }

    function btn_on_click() {
      const dim_l = select_b.value;
      const dim_r = select_a.value;
      l_dim_colors = generate_colors(data[dim_r]['values']);
      update_selects(dim_l, dim_r);
      labels = data[dim_r]['values'].concat(data[dim_l]['values']);

      matrix = update_matrix(dim_l, dim_r);
      update_viz(dim_l, dim_r);
    }

    function update_selects(dim_l, dim_r) {

      let keep_selected_a = dim_l
      let keep_selected_b = dim_r

      let values_a = dimensions.filter(value => value !== keep_selected_b)
      let values_b = dimensions.filter(value => value !== keep_selected_a)

      select_a.innerHTML = ''
      select_b.innerHTML = ''

      values_a.forEach((item) => {
        let opt_a = document.createElement('option');
        opt_a.value = item;
        opt_a.innerHTML = item;
        select_a.appendChild(opt_a);
      })

      values_b.forEach((item) => {
        let opt_b = document.createElement('option');
        opt_b.value = item;
        opt_b.innerHTML = item;
        select_b.appendChild(opt_b);
      })

      select_a.value = keep_selected_a
      select_b.value = keep_selected_b
    }
    d3.selection.prototype.moveToFront = function () {
      return this.each(function () {
        this.parentNode.appendChild(this)
      })
    }

		/*
		 * Initial code
		 */

    //Populate Select
    dimensions.forEach((item, index) => {
      let opt_a = document.createElement('option')
      opt_a.value = item
      opt_a.innerHTML = item
      const opt_b = opt_a.cloneNode(true)
      if (index != 1) select_a.appendChild(opt_a)
      if (index != 0) select_b.appendChild(opt_b)
    })

    select_a.addEventListener("change", select_on_change);
    select_b.addEventListener("change", select_on_change);
    swap_btn.addEventListener("click", btn_on_click);
    select_on_change();
  }
</script>
<script>
  let data = {'TP_SEXO': {'values': ['M', 'F'], 'start_i': 0, 'end_i': 2}, 'TP_COR_RACA': {'values': ['Parda', 'Branca', 'Preta', 'missing value', 'Ind�gena', 'Amarela'], 'start_i': 2, 'end_i': 8}, 'TP_NACIONALIDADE': {'values': ['Brasileiro(a)', 'Brasileiro(a) Naturalizado(a)', 'Brasileiro(a) Nato(a), nascido(a) no exterior', 'Estrangeiro(a)', 'missing value'], 'start_i': 8, 'end_i': 13}, 'TP_ESCOLA': {'values': ['P�blica', 'missing value', 'Exterior', 'Privada'], 'start_i': 13, 'end_i': 17}, 'TP_DEPENDENCIA_ADM_ESC': {'values': ['Estadual', 'Federal', 'missing value', 'Privada', 'Municipal'], 'start_i': 17, 'end_i': 22}, 'TP_LOCALIZACAO_ESC': {'values': ['Urbana', 'missing value', 'Rural'], 'start_i': 22, 'end_i': 25}, 'TP_LINGUA': {'values': ['Ingl�s', 'Espanhol'], 'start_i': 25, 'end_i': 27}, 'Q006': {'values': ['De RS 954,01 at� RS 1.431,00.', 'At� RS 954,00.', 'De RS 1.908,01 at� RS 2.385,00.', 'De RS 1.431,01 at� RS 1.908,00.', 'De RS 2.862,01 at� RS 3.816,00.', 'De RS 3.816,01 at� RS 4.770,00.', 'Nenhuma renda.', 'De RS 8.586,01 at� RS 9.540,00.', 'De RS 5.724,01 at� RS 6.678,00.', 'De RS 2.385,01 at� RS 2.862,00.', 'De RS 6.678,01 at� RS 7.632,00.', 'De RS 4.770,01 at� RS 5.724,00.', 'De RS 9.540,01 at� RS 11.448,00.', 'Mais de RS 19.080,00.', 'De RS 7.632,01 at� RS 8.586,00.', 'De RS 11.448,01 at� RS 14.310,00.', 'De RS 14.310,01 at� RS 19.080,00.'], 'start_i': 27, 'end_i': 44}}
  let full_matrix = [[0.0, 0.0, 210587.0, 193891.0, 55477.0, 10094.0, 3057.0, 9136.0, 468394.0, 11771.0, 1341.0, 596.0, 140.0, 310073.0, 62576.0, 106145.0, 3448.0, 310038.0, 19859.0, 42687.0, 106215.0, 3443.0, 425472.0, 42687.0, 14083.0, 284673.0, 197569.0, 107509.0, 99148.0, 46791.0, 43025.0, 39313.0, 23154.0, 15475.0, 5896.0, 12319.0, 23313.0, 8558.0, 21556.0, 8673.0, 8613.0, 6408.0, 6446.0, 6045.0], [0.0, 0.0, 306372.0, 261282.0, 71228.0, 12683.0, 3980.0, 17137.0, 643965.0, 26094.0, 1722.0, 693.0, 208.0, 445427.0, 97010.0, 125334.0, 4911.0, 445369.0, 21521.0, 75444.0, 125429.0, 4919.0, 578243.0, 75444.0, 18995.0, 338835.0, 333847.0, 169747.0, 174102.0, 61732.0, 54834.0, 45776.0, 25506.0, 29172.0, 6125.0, 13073.0, 26230.0, 8689.0, 22940.0, 8625.0, 7317.0, 6791.0, 6206.0, 5817.0], [210587.0, 306372.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 496656.0, 18893.0, 874.0, 394.0, 142.0, 373600.0, 73747.0, 66077.0, 3535.0, 373535.0, 18561.0, 55157.0, 66166.0, 3540.0, 444525.0, 55157.0, 17277.0, 240488.0, 276471.0, 138079.0, 161314.0, 43896.0, 41974.0, 29626.0, 15502.0, 26930.0, 2815.0, 7042.0, 18165.0, 4581.0, 13243.0, 3754.0, 2087.0, 3321.0, 2499.0, 2131.0], [193891.0, 261282.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 441465.0, 11781.0, 1330.0, 488.0, 109.0, 254203.0, 57132.0, 140249.0, 3589.0, 254188.0, 16302.0, 40790.0, 140307.0, 3586.0, 403967.0, 40790.0, 10416.0, 289307.0, 165866.0, 88344.0, 58705.0, 48540.0, 40464.0, 44822.0, 27716.0, 8973.0, 8091.0, 15738.0, 24986.0, 10933.0, 26347.0, 12077.0, 12804.0, 8627.0, 9129.0, 8877.0], [55477.0, 71228.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 121458.0, 4862.0, 228.0, 129.0, 28.0, 91807.0, 20687.0, 13335.0, 876.0, 91800.0, 4864.0, 15820.0, 13344.0, 877.0, 107416.0, 15820.0, 3469.0, 63636.0, 63069.0, 37115.0, 38777.0, 11218.0, 10794.0, 7062.0, 3344.0, 6090.0, 548.0, 1432.0, 4263.0, 940.0, 2935.0, 592.0, 260.0, 648.0, 403.0, 284.0], [10094.0, 12683.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21782.0, 802.0, 93.0, 55.0, 45.0, 13914.0, 3253.0, 5480.0, 130.0, 13910.0, 754.0, 2498.0, 5485.0, 130.0, 19610.0, 2498.0, 669.0, 12841.0, 9936.0, 5221.0, 5344.0, 2017.0, 1877.0, 1570.0, 963.0, 1060.0, 265.0, 556.0, 925.0, 383.0, 916.0, 409.0, 400.0, 269.0, 312.0, 290.0], [3057.0, 3980.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6645.0, 329.0, 28.0, 33.0, 2.0, 5326.0, 1150.0, 497.0, 64.0, 5325.0, 224.0, 926.0, 498.0, 64.0, 5444.0, 926.0, 667.0, 2999.0, 4038.0, 1917.0, 2552.0, 584.0, 533.0, 311.0, 143.0, 511.0, 25.0, 53.0, 170.0, 43.0, 106.0, 25.0, 13.0, 25.0, 15.0, 11.0], [9136.0, 17137.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24353.0, 1198.0, 510.0, 190.0, 22.0, 16650.0, 3617.0, 5841.0, 165.0, 16649.0, 675.0, 2940.0, 5844.0, 165.0, 22753.0, 2940.0, 580.0, 14237.0, 12036.0, 6580.0, 6558.0, 2268.0, 2217.0, 1698.0, 992.0, 1083.0, 277.0, 571.0, 1034.0, 367.0, 949.0, 441.0, 366.0, 309.0, 294.0, 269.0], [468394.0, 643965.0, 496656.0, 441465.0, 121458.0, 21782.0, 6645.0, 24353.0, 0.0, 0.0, 0.0, 0.0, 0.0, 725489.0, 152934.0, 225841.0, 8095.0, 725401.0, 40410.0, 112449.0, 226002.0, 8097.0, 967975.0, 112449.0, 31935.0, 602774.0, 509585.0, 265439.0, 261167.0, 104568.0, 94170.0, 82495.0, 47374.0, 42478.0, 11782.0, 24865.0, 47972.0, 16908.0, 43397.0, 17007.0, 15676.0, 12933.0, 12437.0, 11691.0], [11771.0, 26094.0, 18893.0, 11781.0, 4862.0, 802.0, 329.0, 1198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27349.0, 6033.0, 4242.0, 241.0, 27344.0, 828.0, 5205.0, 4246.0, 242.0, 31618.0, 5205.0, 1042.0, 17991.0, 19874.0, 10830.0, 11323.0, 3433.0, 3273.0, 2203.0, 1021.0, 2004.0, 171.0, 405.0, 1334.0, 252.0, 898.0, 174.0, 129.0, 186.0, 134.0, 95.0], [1341.0, 1722.0, 874.0, 1330.0, 228.0, 93.0, 28.0, 510.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1686.0, 409.0, 952.0, 16.0, 1686.0, 106.0, 303.0, 952.0, 16.0, 2695.0, 303.0, 65.0, 1979.0, 1084.0, 619.0, 480.0, 351.0, 258.0, 263.0, 193.0, 79.0, 54.0, 95.0, 157.0, 60.0, 130.0, 80.0, 96.0, 50.0, 54.0, 44.0], [596.0, 693.0, 394.0, 488.0, 129.0, 55.0, 33.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 732.0, 158.0, 394.0, 5.0, 732.0, 31.0, 127.0, 394.0, 5.0, 1138.0, 127.0, 24.0, 595.0, 694.0, 286.0, 187.0, 145.0, 127.0, 106.0, 65.0, 44.0, 10.0, 24.0, 66.0, 23.0, 57.0, 35.0, 28.0, 29.0, 26.0, 31.0], [140.0, 208.0, 142.0, 109.0, 28.0, 45.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 244.0, 52.0, 50.0, 2.0, 244.0, 5.0, 47.0, 50.0, 2.0, 289.0, 47.0, 12.0, 169.0, 179.0, 82.0, 93.0, 26.0, 31.0, 22.0, 7.0, 42.0, 4.0, 3.0, 14.0, 4.0, 14.0, 2.0, 1.0, 1.0, 1.0, 1.0], [310073.0, 445427.0, 373600.0, 254203.0, 91807.0, 13914.0, 5326.0, 16650.0, 725489.0, 27349.0, 1686.0, 732.0, 244.0, 0.0, 0.0, 0.0, 0.0, 755399.0, 0.0, 0.0, 86.0, 15.0, 730726.0, 0.0, 24774.0, 371148.0, 384352.0, 214369.0, 224027.0, 75651.0, 67880.0, 49641.0, 20560.0, 35924.0, 2145.0, 6753.0, 28998.0, 4861.0, 17576.0, 2126.0, 447.0, 2543.0, 1249.0, 750.0], [62576.0, 97010.0, 73747.0, 57132.0, 20687.0, 3253.0, 1150.0, 3617.0, 152934.0, 6033.0, 409.0, 158.0, 52.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41380.0, 118131.0, 75.0, 0.0, 35774.0, 118131.0, 5681.0, 83279.0, 76307.0, 42435.0, 39310.0, 15648.0, 14258.0, 11498.0, 5890.0, 6905.0, 1236.0, 2840.0, 6387.0, 2105.0, 5583.0, 1556.0, 720.0, 1364.0, 1010.0, 841.0], [106145.0, 125334.0, 66077.0, 140249.0, 13335.0, 5480.0, 497.0, 5841.0, 225841.0, 4242.0, 952.0, 394.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 231479.0, 0.0, 229650.0, 0.0, 1829.0, 164122.0, 67357.0, 18429.0, 8348.0, 16164.0, 14904.0, 23097.0, 21847.0, 1513.0, 8584.0, 15640.0, 13730.0, 10159.0, 20946.0, 13541.0, 14753.0, 9214.0, 10363.0, 10247.0], [3448.0, 4911.0, 3535.0, 3589.0, 876.0, 130.0, 64.0, 165.0, 8095.0, 241.0, 16.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 8347.0, 7565.0, 0.0, 794.0, 4959.0, 3400.0, 2023.0, 1565.0, 1060.0, 817.0, 853.0, 363.0, 305.0, 56.0, 159.0, 428.0, 122.0, 391.0, 75.0, 10.0, 78.0, 30.0, 24.0], [310038.0, 445369.0, 373535.0, 254188.0, 91800.0, 13910.0, 5325.0, 16649.0, 725401.0, 27344.0, 1686.0, 732.0, 244.0, 755399.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 730634.0, 0.0, 24773.0, 371092.0, 384315.0, 214332.0, 224011.0, 75639.0, 67873.0, 49635.0, 20555.0, 35921.0, 2145.0, 6751.0, 28998.0, 4860.0, 17574.0, 2126.0, 447.0, 2542.0, 1248.0, 750.0], [19859.0, 21521.0, 18561.0, 16302.0, 4864.0, 754.0, 224.0, 675.0, 40410.0, 828.0, 106.0, 31.0, 5.0, 0.0, 41380.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35699.0, 0.0, 5681.0, 24692.0, 16688.0, 8807.0, 6345.0, 4345.0, 3647.0, 4541.0, 2437.0, 652.0, 652.0, 1371.0, 2129.0, 1073.0, 2644.0, 815.0, 242.0, 742.0, 532.0, 406.0], [42687.0, 75444.0, 55157.0, 40790.0, 15820.0, 2498.0, 926.0, 2940.0, 112449.0, 5205.0, 303.0, 127.0, 47.0, 0.0, 118131.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 118131.0, 0.0, 58528.0, 59603.0, 33627.0, 32965.0, 11301.0, 10610.0, 6953.0, 3447.0, 6253.0, 583.0, 1467.0, 4256.0, 1031.0, 2936.0, 734.0, 459.0, 617.0, 472.0, 420.0], [106215.0, 125429.0, 66166.0, 140307.0, 13344.0, 5485.0, 498.0, 5844.0, 226002.0, 4246.0, 952.0, 394.0, 50.0, 86.0, 75.0, 231479.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 229810.0, 0.0, 1834.0, 164228.0, 67416.0, 18465.0, 8361.0, 16177.0, 14915.0, 23107.0, 21859.0, 1514.0, 8585.0, 15644.0, 13732.0, 10162.0, 20951.0, 13548.0, 14772.0, 9220.0, 10370.0, 10262.0], [3443.0, 4919.0, 3540.0, 3586.0, 877.0, 130.0, 64.0, 165.0, 8097.0, 242.0, 16.0, 5.0, 2.0, 15.0, 0.0, 0.0, 8347.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7572.0, 0.0, 790.0, 4968.0, 3394.0, 2025.0, 1568.0, 1061.0, 814.0, 853.0, 362.0, 307.0, 56.0, 159.0, 428.0, 121.0, 391.0, 75.0, 10.0, 78.0, 30.0, 24.0], [425472.0, 578243.0, 444525.0, 403967.0, 107416.0, 19610.0, 5444.0, 22753.0, 967975.0, 31618.0, 2695.0, 1138.0, 289.0, 730726.0, 35774.0, 229650.0, 7565.0, 730634.0, 35699.0, 0.0, 229810.0, 7572.0, 0.0, 0.0, 0.0, 552544.0, 451171.0, 235175.0, 227624.0, 94900.0, 85036.0, 76574.0, 44501.0, 35865.0, 11331.0, 23630.0, 44359.0, 16025.0, 40874.0, 16461.0, 15418.0, 12455.0, 12109.0, 11378.0], [42687.0, 75444.0, 55157.0, 40790.0, 15820.0, 2498.0, 926.0, 2940.0, 112449.0, 5205.0, 303.0, 127.0, 47.0, 0.0, 118131.0, 0.0, 0.0, 0.0, 0.0, 118131.0, 0.0, 0.0, 0.0, 0.0, 0.0, 58528.0, 59603.0, 33627.0, 32965.0, 11301.0, 10610.0, 6953.0, 3447.0, 6253.0, 583.0, 1467.0, 4256.0, 1031.0, 2936.0, 734.0, 459.0, 617.0, 472.0, 420.0], [14083.0, 18995.0, 17277.0, 10416.0, 3469.0, 669.0, 667.0, 580.0, 31935.0, 1042.0, 65.0, 24.0, 12.0, 24774.0, 5681.0, 1829.0, 794.0, 24773.0, 5681.0, 0.0, 1834.0, 790.0, 0.0, 0.0, 0.0, 12436.0, 20642.0, 8454.0, 12661.0, 2322.0, 2213.0, 1562.0, 712.0, 2529.0, 107.0, 295.0, 928.0, 191.0, 686.0, 103.0, 53.0, 127.0, 71.0, 64.0], [284673.0, 338835.0, 240488.0, 289307.0, 63636.0, 12841.0, 2999.0, 14237.0, 602774.0, 17991.0, 1979.0, 595.0, 169.0, 371148.0, 83279.0, 164122.0, 4959.0, 371092.0, 24692.0, 58528.0, 164228.0, 4968.0, 552544.0, 58528.0, 12436.0, 0.0, 0.0, 133155.0, 104899.0, 63365.0, 54166.0, 54884.0, 32957.0, 16952.0, 9500.0, 18429.0, 30742.0, 13000.0, 31392.0, 14242.0, 14588.0, 10181.0, 10704.0, 10352.0], [197569.0, 333847.0, 276471.0, 165866.0, 63069.0, 9936.0, 4038.0, 12036.0, 509585.0, 19874.0, 1084.0, 694.0, 179.0, 384352.0, 76307.0, 67357.0, 3400.0, 384315.0, 16688.0, 59603.0, 67416.0, 3394.0, 451171.0, 59603.0, 20642.0, 0.0, 0.0, 144101.0, 168351.0, 45158.0, 43693.0, 30205.0, 15703.0, 27695.0, 2521.0, 6963.0, 18801.0, 4247.0, 13104.0, 3056.0, 1342.0, 3018.0, 1948.0, 1510.0], [107509.0, 169747.0, 138079.0, 88344.0, 37115.0, 5221.0, 1917.0, 6580.0, 265439.0, 10830.0, 619.0, 286.0, 82.0, 214369.0, 42435.0, 18429.0, 2023.0, 214332.0, 8807.0, 33627.0, 18465.0, 2025.0, 235175.0, 33627.0, 8454.0, 133155.0, 144101.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [99148.0, 174102.0, 161314.0, 58705.0, 38777.0, 5344.0, 2552.0, 6558.0, 261167.0, 11323.0, 480.0, 187.0, 93.0, 224027.0, 39310.0, 8348.0, 1565.0, 224011.0, 6345.0, 32965.0, 8361.0, 1568.0, 227624.0, 32965.0, 12661.0, 104899.0, 168351.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [46791.0, 61732.0, 43896.0, 48540.0, 11218.0, 2017.0, 584.0, 2268.0, 104568.0, 3433.0, 351.0, 145.0, 26.0, 75651.0, 15648.0, 16164.0, 1060.0, 75639.0, 4345.0, 11301.0, 16177.0, 1061.0, 94900.0, 11301.0, 2322.0, 63365.0, 45158.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [43025.0, 54834.0, 41974.0, 40464.0, 10794.0, 1877.0, 533.0, 2217.0, 94170.0, 3273.0, 258.0, 127.0, 31.0, 67880.0, 14258.0, 14904.0, 817.0, 67873.0, 3647.0, 10610.0, 14915.0, 814.0, 85036.0, 10610.0, 2213.0, 54166.0, 43693.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [39313.0, 45776.0, 29626.0, 44822.0, 7062.0, 1570.0, 311.0, 1698.0, 82495.0, 2203.0, 263.0, 106.0, 22.0, 49641.0, 11498.0, 23097.0, 853.0, 49635.0, 4541.0, 6953.0, 23107.0, 853.0, 76574.0, 6953.0, 1562.0, 54884.0, 30205.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [23154.0, 25506.0, 15502.0, 27716.0, 3344.0, 963.0, 143.0, 992.0, 47374.0, 1021.0, 193.0, 65.0, 7.0, 20560.0, 5890.0, 21847.0, 363.0, 20555.0, 2437.0, 3447.0, 21859.0, 362.0, 44501.0, 3447.0, 712.0, 32957.0, 15703.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [15475.0, 29172.0, 26930.0, 8973.0, 6090.0, 1060.0, 511.0, 1083.0, 42478.0, 2004.0, 79.0, 44.0, 42.0, 35924.0, 6905.0, 1513.0, 305.0, 35921.0, 652.0, 6253.0, 1514.0, 307.0, 35865.0, 6253.0, 2529.0, 16952.0, 27695.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [5896.0, 6125.0, 2815.0, 8091.0, 548.0, 265.0, 25.0, 277.0, 11782.0, 171.0, 54.0, 10.0, 4.0, 2145.0, 1236.0, 8584.0, 56.0, 2145.0, 652.0, 583.0, 8585.0, 56.0, 11331.0, 583.0, 107.0, 9500.0, 2521.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [12319.0, 13073.0, 7042.0, 15738.0, 1432.0, 556.0, 53.0, 571.0, 24865.0, 405.0, 95.0, 24.0, 3.0, 6753.0, 2840.0, 15640.0, 159.0, 6751.0, 1371.0, 1467.0, 15644.0, 159.0, 23630.0, 1467.0, 295.0, 18429.0, 6963.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [23313.0, 26230.0, 18165.0, 24986.0, 4263.0, 925.0, 170.0, 1034.0, 47972.0, 1334.0, 157.0, 66.0, 14.0, 28998.0, 6387.0, 13730.0, 428.0, 28998.0, 2129.0, 4256.0, 13732.0, 428.0, 44359.0, 4256.0, 928.0, 30742.0, 18801.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [8558.0, 8689.0, 4581.0, 10933.0, 940.0, 383.0, 43.0, 367.0, 16908.0, 252.0, 60.0, 23.0, 4.0, 4861.0, 2105.0, 10159.0, 122.0, 4860.0, 1073.0, 1031.0, 10162.0, 121.0, 16025.0, 1031.0, 191.0, 13000.0, 4247.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [21556.0, 22940.0, 13243.0, 26347.0, 2935.0, 916.0, 106.0, 949.0, 43397.0, 898.0, 130.0, 57.0, 14.0, 17576.0, 5583.0, 20946.0, 391.0, 17574.0, 2644.0, 2936.0, 20951.0, 391.0, 40874.0, 2936.0, 686.0, 31392.0, 13104.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [8673.0, 8625.0, 3754.0, 12077.0, 592.0, 409.0, 25.0, 441.0, 17007.0, 174.0, 80.0, 35.0, 2.0, 2126.0, 1556.0, 13541.0, 75.0, 2126.0, 815.0, 734.0, 13548.0, 75.0, 16461.0, 734.0, 103.0, 14242.0, 3056.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [8613.0, 7317.0, 2087.0, 12804.0, 260.0, 400.0, 13.0, 366.0, 15676.0, 129.0, 96.0, 28.0, 1.0, 447.0, 720.0, 14753.0, 10.0, 447.0, 242.0, 459.0, 14772.0, 10.0, 15418.0, 459.0, 53.0, 14588.0, 1342.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [6408.0, 6791.0, 3321.0, 8627.0, 648.0, 269.0, 25.0, 309.0, 12933.0, 186.0, 50.0, 29.0, 1.0, 2543.0, 1364.0, 9214.0, 78.0, 2542.0, 742.0, 617.0, 9220.0, 78.0, 12455.0, 617.0, 127.0, 10181.0, 3018.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [6446.0, 6206.0, 2499.0, 9129.0, 403.0, 312.0, 15.0, 294.0, 12437.0, 134.0, 54.0, 26.0, 1.0, 1249.0, 1010.0, 10363.0, 30.0, 1248.0, 532.0, 472.0, 10370.0, 30.0, 12109.0, 472.0, 71.0, 10704.0, 1948.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [6045.0, 5817.0, 2131.0, 8877.0, 284.0, 290.0, 11.0, 269.0, 11691.0, 95.0, 44.0, 31.0, 1.0, 750.0, 841.0, 10247.0, 24.0, 750.0, 406.0, 420.0, 10262.0, 24.0, 11378.0, 420.0, 64.0, 10352.0, 1510.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
  plotBidGraph(data, full_matrix, document.getElementById('sel_a_bid_viz'), 
                 document.getElementById('sel_b_bid_viz'), 
                 document.getElementById('swap_btn_bid_viz'))
</script>